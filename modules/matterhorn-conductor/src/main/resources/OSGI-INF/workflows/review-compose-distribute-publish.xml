<definition>
  <id>review-full</id>
  <title>Full workflow, hold for review before processing</title>
  <description>
    A simple workflow that hold to review, transcodes the media into distribution formats, then sends the resulting distribution files,
    along with their associated metadata, to the distribution channels.
  </description>
  <operations>

    <!-- inspect the media -->
    <operation
      id="inspect"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Inspect the media package">
    </operation>

    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode video to Flash preview">
      <configurations>
        <configuration key="source-video-flavor">presenter/source</configuration>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="target-tags">preview</configuration>
        <configuration key="encoding-profile">flash-preview.http</configuration>
      </configurations>
    </operation>

    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode video to Flash preview">
      <configurations>
        <configuration key="source-video-flavor">presentation/source</configuration>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="target-tags">preview</configuration>
        <configuration key="encoding-profile">flash-preview.http</configuration>
      </configurations>
    </operation>

    <!-- hold for review -->
    <operation
      id="review"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Wait for a user to review the media">
      <configurations>
        <configuration key="source-tag">preview</configuration>
      </configurations>
    </operation>

    <!-- run the videosegmentation -->
    <!-- UNCOMMENT TO ACTIVATE
    <operation
      id="segment"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Extract segments from presentation">
      <configurations>
        <configuration key="analysis.track.flavor">presentation/source</configuration>
      </configurations>
    </operation>
    -->

    <!-- encode to flash download -->
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) video to Flash download">
      <configurations>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="source-video-flavor">presenter/source</configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">flash.http</configuration>
      </configurations>
    </operation>
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to Flash download">
      <configurations>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="source-video-flavor">presentation/source</configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">flash.http</configuration>
      </configurations>
    </operation>
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter audio to Flash download">
      <configurations>
        <configuration key="source-audio-flavor">presenter/source</configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">flash.http</configuration>
      </configurations>
    </operation>
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation audio to Flash download">
      <configurations>
        <configuration key="source-audio-flavor">presentation/source</configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">flash.http</configuration>
      </configurations>
    </operation>

    <!-- encode to quicktime download -->
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) to quicktime/mp4 download">
      <configurations>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="source-video-flavor">presenter/source</configuration>
        <configuration key="target-tags">atom, captioning</configuration>
        <configuration key="encoding-profile">mov-low.http</configuration>
      </configurations>
    </operation>
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to quicktime/mpeg4 download">
      <configurations>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="source-video-flavor">presentation/source</configuration>
        <configuration key="target-tags">rss, atom, captioning</configuration>
        <configuration key="encoding-profile">mov-low.http</configuration>
      </configurations>
    </operation>

    <!-- encode to avi download -->
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) to avi/mpeg4 download">
      <configurations>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="source-video-flavor">presenter/source</configuration>
        <configuration key="target-tags">atom</configuration>
        <configuration key="encoding-profile">avi-low.http</configuration>
      </configurations>
    </operation>
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to avi/mpeg4 download">
      <configurations>
        <configuration key="source-audio-flavor">*/source</configuration>
        <configuration key="source-video-flavor">presentation/source</configuration>
        <configuration key="target-tags">rss, atom</configuration>
        <configuration key="encoding-profile">avi-low.http</configuration>
      </configurations>
    </operation>

    <!-- encode to m4a download -->
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) to m4a/aac download">
      <configurations>
        <configuration key="source-audio-flavor">presenter/source</configuration>
        <configuration key="target-tags">rss, atom</configuration>
        <configuration key="encoding-profile">m4a.http</configuration>
      </configurations>
    </operation>
    <operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to m4a/aac download">
      <configurations>
        <configuration key="source-audio-flavor">presentation/source</configuration>
        <configuration key="target-tags">atom</configuration>
        <configuration key="encoding-profile">m4a.http</configuration>
      </configurations>
    </operation>

    <!-- encode to cover image -->
    <operation
      id="image"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) to cover image">
      <configurations>
        <configuration key="source-flavor">presenter/source</configuration>
        <configuration key="source-tags"></configuration>
        <configuration key="target-flavor">cover/source</configuration>
        <configuration key="target-tags">rss, atom</configuration>
        <configuration key="encoding-profile">feed-cover.http</configuration>
        <configuration key="time">1</configuration>
      </configurations>
    </operation>
    <operation
      id="image"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to cover image">
      <configurations>
        <configuration key="source-flavor">presenter/source</configuration>
        <configuration key="source-tags"></configuration>
        <configuration key="target-flavor">cover/source</configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">engage-cover.http</configuration>
        <configuration key="time">1</configuration>
      </configurations>
    </operation>

    <operation
      id="image"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) to cover image">
      <configurations>
        <configuration key="source-flavor">presentation/source</configuration>
        <configuration key="source-tags"></configuration>
        <configuration key="target-flavor">cover/source</configuration>
        <configuration key="target-tags">rss, atom</configuration>
        <configuration key="encoding-profile">feed-cover.http</configuration>
        <configuration key="time">1</configuration>
      </configurations>
    </operation>
    <operation
      id="image"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to cover image">
      <configurations>
        <configuration key="source-flavor">presentation/source</configuration>
        <configuration key="source-tags"></configuration>
        <configuration key="target-flavor">cover/source</configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">engage-cover.http</configuration>
        <configuration key="time">1</configuration>
      </configurations>
    </operation>

    <!-- Generate slide previews -->
    <operation
      id="segmentpreviews"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presentation (screen) to cover image">
      <configurations>
        <configuration key="source-flavor">presenter/source</configuration>
        <configuration key="source-tags"></configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">engage-slides.http</configuration>
      </configurations>
    </operation>
    <operation
      id="segmentpreviews"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode presenter (camera) to cover image">
      <configurations>
        <configuration key="source-flavor">presentation/source</configuration>
        <configuration key="source-tags"></configuration>
        <configuration key="target-tags">engage</configuration>
        <configuration key="encoding-profile">engage-slides.http</configuration>
      </configurations>
    </operation>

    <operation
      id="distribute-download"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Distribute media to the local distribution channel">
      <configurations>
        <configuration key="source-tags">engage,atom,rss</configuration>
        <configuration key="target-tags">publish</configuration>
      </configurations>
    </operation>

    <operation
      id="publish"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Add metadata to the search index">
      <configurations>
        <configuration key="source-tags">publish</configuration>
      </configurations>
    </operation>
  </operations>
</definition>
