<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <title>System Statistics | Opencast Matterhorn</title>
        <link rel="shortcut icon" href="img/favicon.ico" />
        <!-- META -->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <!-- STYLESHEETS -->
        <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.8.6.custom.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery-ui-opencast-admin/jquery-ui-opencast-admin.css" />
        <link rel="stylesheet" type="text/css" href="css/admin.css" />
        
        <!-- SCRIPTS -->
        <script type="text/javascript" src="jquery/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="jquery/jquery-ui-1.8.6.custom.min.js"></script>
        <script type="text/javascript" src="trimpath/trimpath-template-1.0.38.js"></script>
        <script type="text/javascript" src="js/jquery.ui.spinner.js"></script>
        <script type="text/javascript" src="js/oc.utils.js"></script>
        <script type="text/javascript" src="js/oc.statistics.js"></script>	

        <script type="text/javascript">
            $(document).ready( function() {
              $("#tabsWrapper").tabs({
                select: function (event, ui) {
                  switch (ui.index) {
                    case 0:
                      window.location = 'recordings.html';
                      return false;
                      break;
                    case 1:
                      window.location = 'series_list.html';
                      return false;
                      break;
                    case 2:
                      window.location = 'agents_status.html';
                      return false;
                      break;
                    case 3:
                      window.location = 'statistics.html';
                      return false;
                      break;
                  }
                },
                selected: 3
              });
            });
        </script>
    </head>
    <body>
        <div id="pageHeader">
            <span id="currentVersion"></span>
            <a href="/j_spring_security_logout">Log out</a>
            <div class="clear"></div>
        </div>

        <!-- notification that javaScript is disabled -->
        <noscript>
            <center>
                <div style="border:1px solid red;width:530px;margin:20px;">
                    <div style="text-align: left;background:red; color:white;padding-top:2px;padding-bottom:2px;">
                        <div class="icon icon-error" style="margin-left:5px;margin-right:5px;">&nbsp;</div>
                        JavaScript is disabled
                    </div>
                    <div style="padding:10px;">
                        JavaScript is turned off in your web browser, so this site won't work properly! <br />
                        <strong>
                            Please turn JavaScript on to use this site, then refresh the page.
                        </strong>
                    </div>
                </div>
            </center>
        </noscript>

        <div id="wrapper">
            <div id="header">
                <a href="recordings.html" style="text-decoration: none;">
                    <img src="img/MatterhornLogo.png" onclick="document.location='../welcome.html'; return false;" alt="Matterhorn Home Page" title="Matterhorn Home Page" width="104" height="72" align="left" />
                        <h1>Admin Tools</h1>
                </a>
                <a href="http://www.opencastproject.org" id="oc-logo">
                    <img src="img/OpencastLogo.png" width="143" height="38" alt="Opencast Community Project" title="Opencast Community Project" />
                </a>
                <div class="clear"></div>
            </div>

            <div id="tabsWrapper" class="ui-tabs ui-widget ui-widget-content ui-corner-all">
                <ul id="tabs">
                    <li>
                        <a href="#recordings" id="i18n_tab_recording">Recordings</a>
                    </li>
                    <li>
                        <a href="#series" id="i18n_tab_series">Series</a>
                    </li>
                    <li>
                        <a href='#agents_status' id="i18n_tab_agent">Capture Agents</a>
                    </li>
                    <li>
                        <a href="#statistics" id="i18n_tab_statistics">Statistics</a>
                    </li>
                </ul>
                <div id="stage" class="ui-widget">
                    <!-- div id="controlsTopStatistic" class="ui-widget-header ui-corner-top ui-helper-clearfix" -->
                    <div id="controlsTopStatistic" class="ui-helper-clearfix">
                        <div class="state-filter-container">
                            <input type="radio" name="stateSelect" value="servers" id="stats-servers" /><label for="stats-servers">Servers</label>
                            <input type="radio" name="stateSelect" value="services" id="stats-services" /><label for="stats-services">Services</label>
                        </div>
                    </div>
                    <div id="tableContainer" class="ui-widget ui-helper-clearfix"></div>
                </div>

                <div id="templates" style="display:none;">

                    <textarea id="serversTemplate">
{for server in serversView}
<h2><img src={if server.online}{if server.maintenance}"img/icons/maintenance.png" title="Maintenance Mode"{else}"img/icons/available.png" title="Online"{/if}{else}"img/icons/offline.png" title="Offline"{/if}/> ${server.host}</h2>
<table id="statsTable" class="ui-widget" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th id="sortService" width="40%" class="ui-widget-header">Service<span></span></th>
      <th id="sortJobsRunning" width="15%" class="ui-widget-header">Jobs Running<span></span></th>
      <th id="sortJobsQueued" width="15%" class="ui-widget-header">Jobs Queued<span></span></th>
      <th id="sortMeanRunTime" width="15%" class="ui-widget-header">Mean Run Time<span></span></th>
      <th id="sortMeanQueueTime" width="15%" class="ui-widget-header">Mean Queue Time<span></span></th>
    </tr>
  </thead>
  <tbody>
    {for service in server.services}
      <tr valign="top">
        <td class="ui-state-active">
          ${labels[service.id]}
        </td>
        <td class="ui-state-active center">
          ${service.running}
        </td>
        <td class="ui-state-active  center">
          ${service.queued}
        </td>
        <td class="ui-state-active  center">
          ${service.meanRunTime}
        </td>
        <td class="ui-state-active  center">
          ${service.meanQueueTime}
        </td>
      </tr>
  {/for}
	<tr>
	  <td style=" text-align:right; padding-right:10px; font-weight:bold;">Total</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${server.runningTotal}</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${server.queuedTotal}</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${server.meanRunTimeTotal}</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${server.meanQueueTimeTotal}</td>
	</tr>
  </tbody>
</table>
{/for}
                    </textarea>

                    <textarea id="servicesTemplate">
{for service in servicesView}
<h2>{if labels[service.id]}${labels[service.id]}{else}${service.id}{/if}</h2>
<table id="statsTable" class="ui-widget" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th id="sortService" width="40%" class="ui-widget-header">Host<span></span></th>    
      <th id="sortJobsRunning" width="15%" class="ui-widget-header">Jobs Running<span></span></th>
      <th id="sortJobsQueued" width="15%" class="ui-widget-header">Jobs Queued<span></span></th>
      <th id="sortMeanRunTime" width="15%" class="ui-widget-header">Mean Run Time<span></span></th>
      <th id="sortMeanQueueTime" width="15%" class="ui-widget-header">Mean Queue Time<span></span></th>
    </tr>
  </thead>
  <tbody>
    {for server in service.servers}
      <tr valign="top">
        <td class="ui-state-active"">
	  <img style="vertical-align:middle; margin-right:5px;" src={if server.online}"img/icons/available.png" title="Online"{else}{if server.maintenance}"img/icons/maintenance.png" title="Maintenance"{else}"img/icons/offline.png" title="Offline"{/if}{/if}/>
          ${server.host}
        </td>        
        <td class="ui-state-active  center">
          ${server.running}
        </td>
        <td class="ui-state-active  center">
          ${server.queued}
        </td>
        <td class="ui-state-active  center">
          ${server.meanRunTime}
        </td>
        <td class="ui-state-active  center">
          ${server.meanQueueTime}
        </td>
      </tr>
  {/for}
	<tr>
	  <td style="text-align:right; padding-right:10px; font-weight:bold;">Total</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${service.runningTotal}</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${service.queuedTotal}</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${service.meanRunTimeTotal}</td>
	  <td class="ui-state-active center" style="font-weight:bold;"> ${service.meanQueueTimeTotal}</td>
	</tr>
  </tbody>
</table>
{/for}
                    </textarea>

                    <textarea id="noResultsTemplate">

                    </textarea>

                </div>
            </div><!-- END #tabsWrapper -->

        </div><!-- END #wrapper -->
    </body>
</html>
