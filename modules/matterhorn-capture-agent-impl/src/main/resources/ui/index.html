<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <title id="window-title">Opencast Matterhorn - Capture Agent Diagnostics</title>
    <!-- scripts -->
    <script type="text/javascript" src="jquery/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="js/state.js"></script>
</head>
<script type="text/javascript" language="javascript">
var stateURL = "http://" + window.location.hostname + ":8080/state/rest/GetState";
function refreshState(url, target) {
  req = new XMLHttpRequest();
  req.onreadystatechange = function() {getResponse(target);};
  req.open("GET", url, true);
  req.send();
  setTimeout("refreshState(page)", 10000);
}
function getResponse(target)
</script>
<body onload="refreshState>
  
  <p><code>Agent State: <span id="state"></span></code></p>
  
  
	<script type="text/javascript" language="javascript">

	
	function stopCapture() {
		document.location = "http://" + window.location.hostname + ":8080/capture/rest/stopCapture";
	}
	var getState = new XMLHttpRequest();
	getState.open("GET", "http://" + window.location.hostname + ":8080/state/rest/GetState", false);
	getState.send();
	document.write("<p><code>Agent State: " + getState.responseText + "</code></p>");
	
	var start = "http://" + window.location.hostname + ":8080/capture/rest/startCapture"
	var end = "<a href='http://" + window.location.hostname + ":8080/capture/rest/stopCapture'>Stop Capture</a>";
	
	var client = new XMLHttpRequest();
	client.open("GET", "http://" + window.location.hostname + ":8080/capture/rest/configuration", false);
	client.send();
	var form = "<form name='form' action=" + start + " method='POST'><textarea name=config rows='20' cols='100'>" + client.responseText + "</textarea><br>" +
		"<input type='submit' value='Start Capture'>" +
		"<input type='button' value='Stop Capture' onClick='stopCapture()'></form>";
	
	document.write(form);
	</script>
</body>
</html>

